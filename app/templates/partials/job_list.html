<style>
    .job-card {
        position: relative; 
    }

    .btn-trash {
        position: absolute;
        top: 10px;
        right: 10px;
        background: rgba(0, 0, 0, 0.4);
        border: none;
        color: #ef4444;
        width: 32px;
        height: 32px;
        border-radius: 10%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.2s;
        opacity: 0.7;
    }

    .btn-trash:hover {
        background: #ef4444;
        color: white;
        opacity: 1;
        transform: scale(1.1);
    }
</style>

{% if jobs %}
    <div style="background: #1e293b; padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem; border: 1px solid #334155; display: flex; justify-content: space-between; align-items: center; gap: 0 6rem">
        <div>
            {% if from_cache %}
                <span style="color: #f59e0b; font-weight: bold;">‚ö° Cached Results</span>
            {% else %}
                <span style="color: #10b981; font-weight: bold;">üê¢ Fresh Results</span>
            {% endif %}
            
            <div style="font-size: 0.8rem; color: #94a3b8; margin-top: 4px;">
                Last verification: {{ last_updated }} </br>
                ({{ jobs|length }} positions)
            </div>
        </div>

        <button 
            hx-post="/run-scraper?force=true" 
            hx-target="#results-area"
            hx-indicator="#loading"
            hx-include="[name='teams']" 
            style="background: transparent; border: 1px solid #475569; color: #fff; padding: 6px 12px; font-size: 0.8rem; cursor: pointer; border-radius: 4px; width: 40%; margin: 0 auto;"
        >
            ‚Üª Force Refresh
        </button>
    </div>

    <div class="quest-board" style="display: grid; gap: 1rem; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));">
        
        {% for job in jobs %}
            <div class="job-card" style="background: #1e293b; border: 1px solid #334155; padding: 1.25rem; border-radius: 8px; display: flex; flex-direction: column; justify-content: space-between;">
                <form hx-post="/block-job" hx-swap="delete" hx-target="closest .job-card">
                    <input type="hidden" name="link" value="{{ job.link }}">

                    <button type="submit" class="btn-trash" title="Ocultar esta vaga">
                        X
                    </button>
                </form>
                
                <div>
                    <h5 style="margin: 0 0 0.5rem 0; color: #f1f5f9; font-size: 1.1rem;">{{ job.title }}</h5>
                    
                    <span style="background: rgba(148, 163, 184, 0.2); color: #cbd5e1; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; text-transform: uppercase;">
                        {{ job.sector }}
                    </span>
                </div>

                <div style="margin-top: 1rem; font-size: 0.85rem; color: #94a3b8;">
                    
                    <div style="display: flex; align-items: center; gap: 6px; margin-bottom: 4px;">
                        {% if job.remote %}
                            <span style="color: #10b981;">‚óè</span> Remote   
                        {% else %}
                            <span style="color: #f59e0b;">‚óè</span> On-site / Office
                        {% endif %}
                    </div>

                    <div style="display: flex; align-items: center; gap: 6px;">
                        <span>üìÖ</span> Posted: 
                        {% if job.posted_at is string %}
                            {{ job.posted_at }}
                        {% else %}
                            {{ job.posted_at.strftime('%d/%m/%Y') }}
                        {% endif %}
                    </div>
                </div>

                <a href="https://jornada.stone.com.br{{ job.link }}" target="_blank" style="margin-top: 1rem; display: block; text-align: center; background: transparent; border: 1px solid #475569; padding: 0.5rem; color: #e2e8f0; text-decoration: none; border-radius: 6px; transition: 0.2s;">
                    View Application
                </a>
            </div>
        {% endfor %}
        
    </div>
{% else %}
    <div style="text-align: center; padding: 2rem; color: #64748b;">
        No jobs found.
    </div>
{% endif %}